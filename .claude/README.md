# Claude 配置目录说明

这个目录包含 Claude Code 的配置文件，用于规范 Claude 在 CAD 开发工作站的行为。

## 📁 目录结构

```
.claude/
├── README.md                      # 本文件
├── claude_config.json             # Claude 配置文件
├── CLAUDE_BEHAVIOR_RULES.md       # Claude 行为准则（核心）
└── commands/                      # Slash 命令目录
    ├── init.md                    # /init 命令
    └── cad.md                     # /cad 命令
```

## 🎯 配置文件说明

### 1. `CLAUDE_BEHAVIOR_RULES.md`（最重要）

**作用**：定义 Claude 在这个工作站的强制性行为规则

**内容**：
- 10 条强制性行为规则
- CAD 操作规范要求
- 代码编写规范
- 错误处理标准
- 日志输出规范
- 任务识别和自动响应机制

**适用场景**：
- 所有 CAD 相关操作
- 创建/修改 CAD 脚本
- 进行 CAD 测试

### 2. `claude_config.json`

**作用**：提供配置参数和元数据

**内容**：
- 工作站名称和版本
- 触发关键词列表
- 强制规则摘要
- 禁止操作列表
- 默认模块路径
- 权限配置

**使用方式**：自动加载，无需手动操作

### 3. `commands/cad.md`（`/cad` 命令）

**作用**：启动 CAD 开发模式

**使用方法**：
```
用户输入：/cad
```

**效果**：
- 加载完整的 CAD 操作规范
- 设置强制性操作要求
- 提供标准操作流程
- 启用任务执行检查清单

**适用场景**：
- 开始 CAD 开发任务
- 创建 CAD 操作脚本
- 进行 CAD 测试

### 4. `commands/init.md`（`/init` 命令）

**作用**：初始化工作环境

**使用方法**：
```
用户输入：/init
```

**效果**：
- 显示工作站信息
- 列出可用命令
- 说明权限配置
- 提供文档索引

**适用场景**：
- 新会话开始时
- 需要查看环境信息
- 不确定如何开始

## 🚀 使用流程

### 标准工作流程

1. **新会话开始**
   ```
   /init
   ```
   了解环境信息和可用命令

2. **CAD 任务开始**
   ```
   /cad
   ```
   进入 CAD 开发模式，Claude 会：
   - 自动理解 CAD 操作规范
   - 强制使用范式函数
   - 遵循协同机制
   - 详细记录日志

3. **执行任务**
   ```
   请打开 D:/test/sample.dwg 并插入门窗
   ```
   Claude 会：
   - 先阅读相关规范文档
   - 使用正确的范式函数
   - 遵循协同机制等待
   - 输出详细操作日志

### 快速开始示例

**示例 1：简单任务**
```
用户：/cad
用户：打开 D:/test/sample.dwg

Claude：
我识别到这是 CAD 文件操作任务。

第一步：阅读操作规范
[自动读取 CAD_操作规范.md 和 CAD_基本操作范式.md]

第二步：创建操作脚本
按照范式要求，使用 open_dwg_paradigm() 函数...
[创建规范的脚本]

第三步：执行操作
[执行并输出详细日志]
```

**示例 2：测试任务**
```
用户：/cad
用户：测试 CAD 打开和关闭文件功能

Claude：
我识别到这是测试任务。

第一步：阅读测试规范
[自动读取 CAD_测试规范.md]

第二步：使用测试框架
使用 CAD_test_framework.py 创建标准测试...
[创建符合测试八大原则的测试脚本]

第三步：执行测试
[执行并记录详细日志]
```

## 📋 配置检查清单

确保配置正确：

- [x] `.claude/` 目录已创建
- [x] `CLAUDE_BEHAVIOR_RULES.md` 已创建（核心）
- [x] `claude_config.json` 已创建
- [x] `commands/init.md` 已创建
- [x] `commands/cad.md` 已创建
- [ ] 用户已测试 `/init` 命令
- [ ] 用户已测试 `/cad` 命令

## 🔧 自定义配置

### 添加新的 Slash 命令

在 `commands/` 目录下创建新的 `.md` 文件：

```bash
.claude/commands/mycommand.md
```

使用方法：
```
/mycommand
```

### 修改行为规则

编辑 `CLAUDE_BEHAVIOR_RULES.md`，添加或修改规则。

建议的修改流程：
1. 识别需要改进的地方
2. 在文档中添加新规则或修改现有规则
3. 测试新规则是否生效
4. 记录更新日志

### 更新配置参数

编辑 `claude_config.json`，修改相关参数。

常用修改：
- 添加触发关键词
- 更新路径配置
- 调整权限设置

## 🎯 配置生效机制

### 自动触发

当用户消息包含触发关键词时，Claude 会自动：
1. 识别这是 CAD 相关任务
2. 回忆行为准则中的相关规则
3. 在执行前阅读规范文档
4. 严格按照规范执行

**触发关键词**（见 `claude_config.json`）：
- CAD, AutoCAD, 天正, TArch
- DWG, 图纸, dwg
- 打开, 新建, 关闭, 保存
- 插入, 块, block
- 墙体, 门, 窗, 标注
- 测试, test, 脚本

### 手动触发

使用 Slash 命令明确触发：
- `/init` - 初始化环境
- `/cad` - 进入 CAD 模式

## 📚 相关文档

配置系统依赖的规范文档：

- `CAD_操作规范.md` - 六大核心规则
- `CAD_基本操作范式.md` - 五大基本操作范式
- `CAD_快速参考.md` - 快速参考
- `CAD_测试规范.md` - 测试八大原则
- `文档索引.md` - 完整文档导航

## 🔍 故障排查

### 问题：Claude 没有按规范操作

**可能原因**：
1. 没有使用 `/cad` 命令
2. 任务描述不包含触发关键词
3. 规范文档位置不正确

**解决方法**：
1. 明确使用 `/cad` 命令
2. 在任务描述中明确提到"CAD"或相关关键词
3. 检查规范文档是否在根目录

### 问题：Slash 命令不工作

**可能原因**：
1. 文件扩展名不是 `.md`
2. 文件位置不在 `commands/` 目录
3. 文件内容格式错误

**解决方法**：
1. 确保文件名为 `命令名.md`
2. 确保文件在 `.claude/commands/` 目录
3. 检查文件内容格式

### 问题：配置修改不生效

**可能原因**：
1. JSON 格式错误
2. 缓存问题

**解决方法**：
1. 验证 JSON 格式正确
2. 重新加载或重启会话

## 📝 维护日志

### 版本 1.0（2025-11-10）

**创建内容**：
- ✅ 创建 `.claude/` 目录结构
- ✅ 创建 `CLAUDE_BEHAVIOR_RULES.md`（10条强制规则）
- ✅ 创建 `claude_config.json`（配置参数）
- ✅ 创建 `/init` 命令
- ✅ 创建 `/cad` 命令
- ✅ 创建配置说明文档

**功能**：
- 强制执行 CAD 操作规范
- 自动识别 CAD 任务
- 强制使用范式函数
- 自动阅读规范文档
- 详细日志输出

## 💡 最佳实践

1. **每次新会话开始时使用 `/init`**
   - 了解环境状态
   - 查看可用命令

2. **执行 CAD 任务前使用 `/cad`**
   - 确保 Claude 理解规范
   - 启用严格模式

3. **任务描述要清晰**
   - 明确提到"CAD"
   - 说明具体操作（打开、新建等）
   - 提供完整的文件路径

4. **定期检查规范文档**
   - 确保规范文档存在
   - 内容准确完整
   - 及时更新

5. **遇到问题时查看日志**
   - Claude 会输出详细日志
   - 检查是否遵循了规范
   - 查看错误信息

## 🎓 学习资源

要理解配置系统的工作原理，建议阅读：

1. **核心文档**（必读）
   - `.claude/CLAUDE_BEHAVIOR_RULES.md`
   - `.claude/commands/cad.md`

2. **规范文档**（必读）
   - `CAD_操作规范.md`
   - `CAD_基本操作范式.md`

3. **参考文档**（可选）
   - `CAD_快速参考.md`
   - `文档索引.md`

---

**版本**：1.0
**创建日期**：2025-11-10
**维护者**：CAD 开发工作站

**如有问题或建议，请更新本文档或相关配置文件。**
