# 项目脚本说明

## 脚本列表

### 1. create_plot_map.py
**用途**: 创建第一张私宅总图DWG文件

**功能**:
- 根据地理坐标创建DWG文件
- 绘制4个坐标点
- 用闭合多段线连接所有点
- 自动坐标转换（X↔Y）

**坐标点**:
- 点1: (3084591.190, 380592.128)
- 点2: (3084586.139, 380581.243)
- 点3: (3084577.068, 380585.452)
- 点4: (3084582.119, 380596.337)

**输出文件**: `私宅总图.dwg`

### 2. create_plot_map_2.py
**用途**: 创建第二张私宅总图DWG文件

**功能**:
- 根据地理坐标创建DWG文件
- 绘制6个坐标点
- 用开放多段线按顺序连接点
- 自动坐标转换（X↔Y）

**坐标点**:
- P1: (3083641.673, 381378.081)
- P2: (3083634.821, 381387.414)
- P3: (3083644.548, 381393.696)
- P4: (3083645.613, 381393.914)
- P5: (3083648.003, 381392.157)
- P6: (3083651.207, 381388.858)

**输出文件**: `私宅总图_第二张图.dwg`

## 使用方法

```bash
# 创建第一张图
python create_plot_map.py

# 创建第二张图
python create_plot_map_2.py
```

## 坐标转换说明

这两个脚本都使用绝对坐标，并进行X/Y轴转换：
- **地理X坐标** → **DWG Y坐标**
- **地理Y坐标** → **DWG X坐标**

例如：
- 地理坐标输入：(3084591.190, 380592.128)
- DWG实际坐标：(380592.128, 3084591.190)

## 注意事项

1. 脚本会自动启动和关闭天正CAD V9
2. 执行完成后文件保存在 `D:\claude-tasks\drawings\YYYY-MM-DD\` 目录
3. 脚本会自动处理CAD进程，确保只有一个CAD实例运行
4. 绘图完成后会自动调整视图（ZOOM EXTENTS）

## 依赖

这些脚本依赖以下模块：
- `CAD_basic` - CAD启动和关闭
- `CAD_basic_operations` - 文件操作（新建、保存、关闭）
- `CAD_coordination` - 同步机制

## 版本历史

- **2025-11-07**: 修正坐标系统，使用绝对坐标而非相对坐标
- **2025-11-07**: 创建初始版本
