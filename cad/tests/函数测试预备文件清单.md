# CAD_file_operations.py 函数测试预备文件清单

**更新日期**: 2025-11-17
**适用文件**: `D:/claude-tasks/cad/scripts/CAD_file_operations.py`

---

## 一、函数测试文件对照表

| 序号 | 函数名 | 预备DWG文件 | 测试脚本 | 测试状态 |
|------|--------|-------------|----------|----------|
| 1 | `new_file()` | 无需（创建新文件） | `test_new_file.py` | 待测 |
| 2 | `open_file()` | `preset_open.dwg` | `test_open_file.py` | 待测 |
| 3 | `copy_file_with_increment()` | `preset_copy_source.dwg` | `test_copy_file_increment.py` | ✅已测 |
| 4 | `save_file()` | 无需（保存当前文件） | `test_save_file.py` | 待测 |
| 5 | `save_file_as()` | `preset_saveas_source.dwg` | `test_save_file_as.py` | 待测 |
| 6 | `close_file()` | `preset_close.dwg` | `test_close_file.py` | 待测 |
| 7 | `close_all_files()` | `preset_close_all_1.dwg`<br>`preset_close_all_2.dwg` | `test_close_all_files.py` | ✅已测 |
| 8 | `insert_file_as_block()` | `preset_block_source.dwg`<br>`preset_block_target.dwg` | `test_insert_as_block.py` | ✅已测 |
| 9 | `insert_file_exploded()` | `preset_explode_source.dwg`<br>`preset_explode_target.dwg` | `test_insert_exploded.py` | ✅已测 |
| 10 | `copy_file_content_pywin32()` | `preset_content_source.dwg`<br>`preset_content_target.dwg` | `test_copy_file_content.py` | 待测 |
| 11 | `insert_region_from_file()` | `preset_region_source.dwg` | `test_insert_region_from_file_optimized.py` | ✅已测 |
| 12 | `insert_region_between_files()` | `preset_region_A.dwg`<br>`preset_region_B.dwg` | `test_insert_region_between_files.py` | ✅已测 |
| 13 | `dim_by_points()` | `preset_dim_target.dwg` | `test_dim_by_points.py` | 待测 |
| 14 | `draw_tarch_wall()` | `preset_wall_target.dwg` | `test_draw_tarch_wall_fixed.py` | ✅已测 |
| 15 | `insert_tarch_door()` | `preset_door_wall.dwg` | `test_insert_tarch_door_triangle.py` | ✅已测 |
| 16 | `insert_tarch_window()` | `preset_window_wall.dwg` | `test_insert_tarch_window_rectangle.py` | ✅已测 |
| 17 | `start_cad_session()` | 无需（启动CAD） | `test_start_cad_session.py` | 待测 |
| 18 | `restore_to_uncertain_state()` | 无需（恢复状态） | `test_restore_state.py` | ✅已测 |
| 19 | `activate_document_by_name()` | `preset_activate_1.dwg`<br>`preset_activate_2.dwg` | `test_activate_document.py` | ✅已测 |
| 20 | `cad_zt_zero()` | 无需（清理进程） | `test_cad_zt_zero.py` | 待测 |
| 21 | `cad_zt_oneb()` | 无需（状态管理） | `test_cad_zt_oneb.py` | 待测 |
| 22 | `cad_zt_oned()` | `0.dwg`（系统文件） | `test_cad_zt_oned.py` | 待测 |
| 23 | `cad_zt_two()` | `0.dwg`, `1.dwg`（系统文件） | `test_cad_zt_two.py` | 待测 |
| 24 | `cad_zt_much()` | `0.dwg`, `1.dwg`, `2.dwg`（系统文件） | `test_cad_zt_much.py` | 待测 |

---

## 二、预备文件存放位置

```
D:/claude-tasks/cad/tests/test_files/preset/
├── preset_open.dwg                 # open_file测试
├── preset_copy_source.dwg          # copy_file_with_increment测试
├── preset_saveas_source.dwg        # save_file_as测试
├── preset_close.dwg                # close_file测试
├── preset_close_all_1.dwg          # close_all_files测试
├── preset_close_all_2.dwg          # close_all_files测试
├── preset_block_source.dwg         # insert_file_as_block测试（源）
├── preset_block_target.dwg         # insert_file_as_block测试（目标）
├── preset_explode_source.dwg       # insert_file_exploded测试（源）
├── preset_explode_target.dwg       # insert_file_exploded测试（目标）
├── preset_content_source.dwg       # copy_file_content_pywin32测试（源）
├── preset_content_target.dwg       # copy_file_content_pywin32测试（目标）
├── preset_region_source.dwg        # insert_region_from_file测试
├── preset_region_A.dwg             # insert_region_between_files测试（目标）
├── preset_region_B.dwg             # insert_region_between_files测试（源）
├── preset_dim_target.dwg           # dim_by_points测试
├── preset_wall_target.dwg          # draw_tarch_wall测试
├── preset_door_wall.dwg            # insert_tarch_door测试（带墙）
├── preset_window_wall.dwg          # insert_tarch_window测试（带墙）
├── preset_activate_1.dwg           # activate_document_by_name测试
└── preset_activate_2.dwg           # activate_document_by_name测试
```

---

## 三、预备文件内容规范

### 3.1 基础空文件
- **适用函数**：`new_file`, `save_file`, `save_file_as`
- **内容**：空白DWG文件（无图形对象）
- **用途**：测试文件创建和保存功能

### 3.2 简单图形文件
- **适用函数**：`open_file`, `close_file`, `copy_file_with_increment`
- **内容**：包含1-3个简单图形（圆、矩形）
- **用途**：测试文件打开和关闭功能

### 3.3 复杂图形文件
- **适用函数**：`insert_file_as_block`, `insert_file_exploded`, `copy_file_content_pywin32`
- **内容**：包含多种图形和图层
- **用途**：测试文件内容复制和插入功能

### 3.4 区域测试文件
- **适用函数**：`insert_region_from_file`, `insert_region_between_files`
- **内容**：
  - 源文件：不同区域包含不同图形
  - 目标文件：初始简单图形
- **用途**：测试区域选择和插入功能

### 3.5 天正墙体文件
- **适用函数**：`draw_tarch_wall`, `insert_tarch_door`, `insert_tarch_window`
- **内容**：包含天正墙体对象
- **用途**：测试天正建筑功能

### 3.6 多文档测试文件
- **适用函数**：`activate_document_by_name`, `close_all_files`
- **内容**：多个独立的DWG文件
- **用途**：测试多文档管理功能

---

## 四、快速测试指南

### 4.1 运行单个函数测试

```bash
# 测试 insert_region_between_files
python D:\claude-tasks\cad\tests\test_insert_region_between_files.py

# 测试 draw_tarch_wall
python D:\claude-tasks\cad\tests\test_draw_tarch_wall_fixed.py

# 测试 insert_tarch_door
python D:\claude-tasks\cad\tests\test_insert_tarch_door_triangle.py
```

### 4.2 运行全部测试

```bash
python D:\claude-tasks\cad\tests\run_all_function_tests.py
```

### 4.3 生成测试报告

```bash
python D:\claude-tasks\cad\tests\generate_excel_report.py
```

---

## 五、测试状态统计

| 状态 | 数量 | 百分比 |
|------|------|--------|
| ✅ 已测试 | 10 | 42% |
| 待测试 | 14 | 58% |
| **总计** | **24** | **100%** |

### 已测试函数列表
1. ✅ `copy_file_with_increment()`
2. ✅ `close_all_files()`
3. ✅ `insert_file_as_block()`
4. ✅ `insert_file_exploded()`
5. ✅ `insert_region_from_file()`
6. ✅ `insert_region_between_files()`
7. ✅ `draw_tarch_wall()`
8. ✅ `insert_tarch_door()`
9. ✅ `insert_tarch_window()`
10. ✅ `restore_to_uncertain_state()`

### 待测试函数列表（优先级排序）

**高优先级**（核心功能）：
1. `new_file()`
2. `open_file()`
3. `save_file()`
4. `save_file_as()`
5. `close_file()`

**中优先级**（进阶功能）：
6. `copy_file_content_pywin32()`
7. `dim_by_points()`
8. `activate_document_by_name()`

**低优先级**（状态管理）：
9. `start_cad_session()`
10. `cad_zt_zero()`
11. `cad_zt_oneb()`
12. `cad_zt_oned()`
13. `cad_zt_two()`
14. `cad_zt_much()`

---

**文档维护要求**：
- 每次新增函数：更新此清单
- 每次测试完成：标记测试状态
- 每次修改函数：重新测试并更新状态
