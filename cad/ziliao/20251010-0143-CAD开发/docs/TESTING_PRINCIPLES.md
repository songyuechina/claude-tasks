# 测试与验收通用原则（20251010-0143-CAD开发）

适用于本任务目录内的所有程序脚本，强调过程可观测、结果可判定、日志可追溯。

- 统一日志位置（任务目录内）
  - 运行日志：`artifacts/logs/<脚本名>/`
  - 封装日志（CAD 控制器）：`artifacts/logs/cad_automation.log`

- 判定的通用法则（与脚本无关的普适规则）
  1) 脚本在流程中应设置“关键节点”（checkpoints），并在到达时输出可识别的关键消息（建议格式：`CHECKPOINT: <name>`），同时记录到 `*.json` 总结中。
  2) 每个关键节点都应被实际触达（运行日志和 JSON 均能看到对应 checkpoint）。
  3) 脚本走到最终结束点并打印完成消息，同时整个过程未出现错误反馈（运行日志中无 `ERROR`，JSON 汇总的 `errors` 为空），则判定为通过（`verdict=PASS`）。

- 建议验证流程（示例）
  - 标准化环境：`python cad_cli.py standard <源文件路径.dwg>`
  - 运行目标脚本：见各脚本自带的 `usage` 说明
  - 查看总结：到 `artifacts/logs/<脚本名>/` 中查找最新的 `*.json`，确认 `checkpoints` 满足要求、`errors` 为空、`verdict=PASS`

- 脚本级（场景特定）判定
  - 在 `docs/CRITERIA_<脚本标识>.md` 中定义具体脚本的补充判定（例如层数=文件数等）；通用法则始终适用，脚本级判定用于在此基础上增强约束。

要求：新脚本需按以上通用法则输出运行日志与 JSON 总结；如需写到任务目录外，必须是使用者显式传参或说明允许的场景。
