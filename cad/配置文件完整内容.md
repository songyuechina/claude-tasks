# 配置文件完整内容索引

本文档列出所有配置文件的位置和关键内容摘要。

## 📁 配置文件列表

### 1. `.claude/CLAUDE_BEHAVIOR_RULES.md`

**路径**：`.claude/CLAUDE_BEHAVIOR_RULES.md`

**作用**：定义 Claude 的强制性行为准则

**文件大小**：约 15KB

**关键内容**：

#### 10 条强制性行为规则

1. **规则 1：CAD 操作前必读文档**
   - 触发条件：提到"CAD"、"天正"、"DWG"等
   - 执行动作：先读取 CAD_操作规范.md 和 CAD_基本操作范式.md

2. **规则 2：必须使用范式函数**
   - 禁止：直接使用 `acad.Documents.Open()`
   - 强制：使用 `open_dwg_paradigm()`

3. **规则 3：协同机制强制执行**
   - 每个命令后必须 `wait_quiescent()`
   - 使用 `send_cmd_with_sync()` 发送同步命令

4. **规则 4：启动 CAD 的标准流程**
   - 使用 `start_cad_session_with_coordination()`
   - 通过天正启动，启动弹窗治理

5. **规则 5：测试任务的标准流程**
   - 阅读 CAD_测试规范.md
   - 使用 CAD_test_framework.py

6. **规则 6：错误处理标准**
   - 详细的 try-except 块
   - 记录完整的错误信息

7. **规则 7：代码创建规范**
   - 标准的脚本模板
   - 包含所有必需的导入和错误处理

8. **规则 8：日志输出规范**
   - 使用规范的日志图标（🔄 ✅ ❌ ⚠️）
   - 详细记录每个操作步骤

9. **规则 9：文件路径规范**
   - 使用 Path 对象
   - 处理中文路径（短路径）

10. **规则 10：权限管理规范**
    - 完全权限区域：D:\claude-tasks\
    - 其他区域需询问

**查看方式**：
```bash
cat .claude/CLAUDE_BEHAVIOR_RULES.md | head -100
```

---

### 2. `.claude/commands/cad.md`

**路径**：`.claude/commands/cad.md`

**作用**：`/cad` 命令的定义

**文件大小**：约 7KB

**关键内容**：

#### 核心使命
- 你是 CAD 自动化开发助手
- 所有操作必须严格遵循规范体系

#### 必读文档（按顺序）
1. CAD_操作规范.md - 六大核心规则
2. CAD_基本操作范式.md - 五大基本操作范式
3. CAD_快速参考.md - 常用操作快速参考

#### 强制性操作规范
- CAD 启动规范
- 协同机制规范
- 基本操作范式
- CAD 四个核心状态
- 测试规范

#### 标准操作流程
- 启动 CAD 会话
- 打开/新建/保存/关闭文件
- 插入块

#### 错误处理规范
- 超时设置
- 失败重试
- 日志记录

**使用方式**：
```
/cad
```

**查看方式**：
```bash
cat .claude/commands/cad.md
```

---

### 3. `.claude/commands/init.md`

**路径**：`.claude/commands/init.md`

**作用**：`/init` 命令的定义

**文件大小**：约 1KB

**关键内容**：

#### 环境信息
- 工作目录：D:\claude-tasks
- 工作模式：CAD 自动化开发
- Python 版本：3.11.5

#### 核心规范
- CAD_操作规范.md
- CAD_基本操作范式.md
- CAD_快速参考.md
- .claude/CLAUDE_BEHAVIOR_RULES.md

#### 快速命令
- /cad - 启动 CAD 开发模式
- /init - 初始化环境

#### 权限配置
- 完全权限区域
- 其他区域

**使用方式**：
```
/init
```

**查看方式**：
```bash
cat .claude/commands/init.md
```

---

### 4. `.claude/claude_config.json`

**路径**：`.claude/claude_config.json`

**作用**：配置参数和元数据

**文件大小**：约 1.5KB

**关键内容**：

```json
{
  "name": "CAD Development Workstation",
  "version": "1.0",
  "behavior": {
    "mode": "cad_automation",
    "strict_compliance": true,
    "auto_read_docs": true
  },
  "trigger_keywords": [
    "CAD", "AutoCAD", "天正", "TArch",
    "DWG", "图纸", "dwg",
    "打开", "新建", "关闭", "保存",
    "插入", "块", "block",
    "墙体", "门", "窗", "标注",
    "测试", "test", "脚本"
  ],
  "mandatory_rules": {
    "cad_startup": "必须通过天正软件启动 CAD",
    "dialog_killer": "必须启动弹窗治理脚本",
    "coordination": "必须使用协同机制",
    "paradigm_functions": "必须使用范式函数",
    "logging": "所有操作必须有详细日志输出"
  },
  "forbidden_actions": [
    "直接启动 acad.exe",
    "直接调用 acad.Documents.Open()",
    "快速连续发送多个命令",
    "不等待命令完成",
    "不启动弹窗治理"
  ]
}
```

**查看方式**：
```bash
cat .claude/claude_config.json
```

---

### 5. `.claude/README.md`

**路径**：`.claude/README.md`

**作用**：配置目录说明文档

**文件大小**：约 10KB

**关键内容**：

#### 目录结构
```
.claude/
├── README.md
├── CLAUDE_BEHAVIOR_RULES.md
├── claude_config.json
└── commands/
    ├── init.md
    └── cad.md
```

#### 配置文件说明
- CLAUDE_BEHAVIOR_RULES.md - 最重要
- claude_config.json - 配置参数
- commands/cad.md - /cad 命令
- commands/init.md - /init 命令

#### 使用流程
- 新会话开始：/init
- CAD 任务开始：/cad
- 执行任务：按规范操作

#### 故障排查
- Claude 没有按规范操作
- Slash 命令不工作
- 配置修改不生效

**查看方式**：
```bash
cat .claude/README.md
```

---

### 6. `.claude/verify_config.py`

**路径**：`.claude/verify_config.py`

**作用**：配置验证脚本

**文件大小**：约 6KB

**功能**：
- 检查目录结构
- 检查配置文件
- 检查 JSON 格式
- 检查规范文档
- 检查核心模块
- 统计验证结果

**运行方式**：
```bash
python .claude/verify_config.py
```

**输出示例**：
```
============================================================
Claude 配置验证
============================================================

📁 检查目录结构...
  ✅ .claude\commands

📄 检查配置文件...
  ✅ .claude\README.md
  ✅ .claude\CLAUDE_BEHAVIOR_RULES.md
  ...

============================================================
验证结果统计
============================================================

总计: 16 项
✅ 通过: 16 项
❌ 失败: 0 项
通过率: 100.0%
```

---

### 7. `.claude/settings.local.json`

**路径**：`.claude/settings.local.json`

**作用**：Claude Code 权限设置

**文件大小**：约 0.1KB

**内容**：
```json
{
  "permissions": {
    "allow": [
      "Bash(python:*)"
    ],
    "deny": [],
    "ask": []
  }
}
```

**说明**：
- 允许执行所有 Python 命令
- 无拒绝项
- 无询问项

---

## 📚 相关规范文档

这些文档不在 `.claude/` 目录，但被配置系统引用：

### 1. CAD_操作规范.md

**位置**：根目录

**作用**：六大核心规则

**关键内容**：
1. 启动方式（通过天正）
2. CAD 四个核心状态
3. 物理驱动等待机制
4. 弹窗治理机制
5. 统一操作入口
6. 进程约束策略

### 2. CAD_基本操作范式.md

**位置**：根目录

**作用**：五大基本操作范式

**关键内容**：
1. 新建文件范式
2. 打开文件范式
3. 关闭文件范式
4. 保存文件范式
5. 插入文件范式

### 3. CAD_快速参考.md

**位置**：根目录

**作用**：快速参考指南

**关键内容**：
- 核心原则
- CAD 四个核心状态
- 常用操作函数
- 常见错误和解决方案

### 4. CAD_测试规范.md

**位置**：根目录

**作用**：测试八大原则

**关键内容**：
- 测试前归位
- 单进程测试
- 幂等性保证
- 详细日志记录
- 等等...

---

## 🔧 配置文件关系图

```
用户
  |
  |-- /init ------> .claude/commands/init.md
  |                   |
  |                   +---> 显示环境信息
  |
  |-- /cad -------> .claude/commands/cad.md
  |                   |
  |                   +---> 加载 CLAUDE_BEHAVIOR_RULES.md
  |                   |
  |                   +---> 引用 CAD_操作规范.md
  |                   |
  |                   +---> 引用 CAD_基本操作范式.md
  |
  |-- CAD任务 ----> 自动触发（关键词匹配）
                      |
                      +---> claude_config.json (关键词列表)
                      |
                      +---> CLAUDE_BEHAVIOR_RULES.md (行为规则)
                      |
                      +---> 阅读规范文档
                      |
                      +---> 执行规范操作
```

---

## 📋 快速检查清单

配置系统就绪检查：

- [ ] `.claude/` 目录存在
- [ ] `CLAUDE_BEHAVIOR_RULES.md` 存在且完整
- [ ] `claude_config.json` 存在且格式正确
- [ ] `commands/init.md` 存在
- [ ] `commands/cad.md` 存在
- [ ] `verify_config.py` 可以运行
- [ ] 规范文档存在（CAD_操作规范.md 等）
- [ ] 核心模块存在（scripts/ 目录下）
- [ ] `/init` 命令可用
- [ ] `/cad` 命令可用

**验证方式**：
```bash
python .claude/verify_config.py
```

---

## 🎯 文件大小统计

| 文件 | 大小（约） | 行数（约） |
|------|-----------|-----------|
| CLAUDE_BEHAVIOR_RULES.md | 15KB | 400 |
| commands/cad.md | 7KB | 200 |
| commands/init.md | 1KB | 30 |
| claude_config.json | 1.5KB | 60 |
| README.md | 10KB | 300 |
| verify_config.py | 6KB | 160 |
| settings.local.json | 0.1KB | 10 |
| **总计** | **~40KB** | **~1200** |

---

## 💡 使用建议

### 查看完整内容

使用以下命令查看各个文件的完整内容：

```bash
# 查看行为准则（最重要）
cat .claude/CLAUDE_BEHAVIOR_RULES.md

# 查看 /cad 命令定义
cat .claude/commands/cad.md

# 查看 /init 命令定义
cat .claude/commands/init.md

# 查看配置参数
cat .claude/claude_config.json

# 查看配置说明
cat .claude/README.md

# 运行验证脚本
python .claude/verify_config.py
```

### 修改配置

1. **修改行为规则**：编辑 `CLAUDE_BEHAVIOR_RULES.md`
2. **修改命令定义**：编辑 `commands/cad.md` 或 `commands/init.md`
3. **修改配置参数**：编辑 `claude_config.json`
4. **验证修改**：运行 `python .claude/verify_config.py`

### 备份配置

```bash
# 备份整个配置目录
cp -r .claude .claude_backup_$(date +%Y%m%d)

# 或者只备份关键文件
tar -czf claude_config_backup.tar.gz .claude/
```

---

## 📝 版本信息

- **版本**：1.0
- **创建日期**：2025-11-10
- **配置文件总数**：7 个
- **总大小**：约 40KB
- **总行数**：约 1200 行

---

## 🔗 相关文档

- **使用指南**：`配置系统使用指南.md`
- **配置说明**：`.claude/README.md`
- **规范索引**：`文档索引.md`
- **工作站 README**：`README.md`

---

**本文档提供配置文件的完整索引和内容摘要。**
**要查看完整内容，请直接打开对应的文件。**
