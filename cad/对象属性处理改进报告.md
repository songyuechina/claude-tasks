# CAD å¯¹è±¡å±æ€§å¤„ç†æ”¹è¿›æŠ¥å‘Š

**ä»»åŠ¡æ¥æº**ï¼šD:/claude-tasks/å³æ—¶å¯¹è¯.txt
**å®Œæˆæ—¥æœŸ**ï¼š2025-11-10
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

---

## ğŸ“‹ ä»»åŠ¡ç›®æ ‡

å®Œå–„ CAD å¯¹è±¡å±æ€§çš„å¤„ç†æœºåˆ¶ï¼Œå®ç°ï¼š

1. **CAD æ ‡å‡†å¯¹è±¡**ï¼ˆå¦‚å¤šæ®µçº¿ã€åœ†ã€ç›´çº¿ç­‰ï¼‰
   - ä½¿ç”¨ `_maybe_cast()` å‡½æ•°è¿›è¡Œç±»å‹è½¬æ¢
   - è½¬æ¢åå¯ä»¥ç›´æ¥è®¿é—®å±æ€§ï¼ˆå¦‚ `ob.Coordinates`ï¼‰

2. **å¤©æ­£å¯¹è±¡**ï¼ˆå¦‚é—¨çª—ã€å¢™ä½“ç­‰ï¼‰
   - ä½¿ç”¨ `get_object_property()` å‡½æ•°è®¿é—®å±æ€§
   - ä½¿ç”¨ `set_object_property()` å‡½æ•°è®¾ç½®å±æ€§

---

## ğŸ”§ ä¿®æ”¹å†…å®¹

### 1. æ›´æ–° `scripts/CAD_basic.py` ç¬¬åä¸€éƒ¨åˆ†

**æ–‡ä»¶ä½ç½®**ï¼š`D:/claude-tasks/scripts/CAD_basic.py`ï¼ˆç¬¬ 14798-14888 è¡Œï¼‰

#### ä¿®æ”¹ç‚¹ 1ï¼šå®Œå–„ `_CAST_MAP` æ˜ å°„

**ä¿®æ”¹å‰**ï¼ˆä»… 12 ä¸ªæ˜ å°„ï¼‰ï¼š
```python
_CAST_MAP = {
    "AcDbLine": "IAcadLine", "AcDbCircle": "IAcadCircle", "AcDbArc": "IAcadArc",
    "AcDbPoint": "IAcadPoint", "AcDbEllipse": "IAcadEllipse", "AcDbSpline": "IAcadSpline",
    "AcDbPolyline": "IAcadLWPolyline", "AcDb2dPolyline": "IAcadPolyline",
    "AcDb3dPolyline": "IAcad3DPolyline", "AcDbText": "IAcadText", "AcDbMText": "IAcadMText",
    "AcDbBlockReference": "IAcadBlockReference", "AcDbLeader": "IAcadLeader",
    "AcDbMLeader": "IAcadMLeader", "AcDbHatch": "IAcadHatch", "AcDbTable": "IAcadTable",
}
```

**ä¿®æ”¹å**ï¼ˆ27 ä¸ªæ˜ å°„ï¼Œä¸ç¬¬å››éƒ¨åˆ†ä¸€è‡´ï¼‰ï¼š
```python
_CAST_MAP = {
    # åŸºç¡€å‡ ä½•
    "AcDbLine":"IAcadLine", "AcDbCircle":"IAcadCircle", "AcDbArc":"IAcadArc","AcDbPoint":"IAcadPoint",
    "AcDbEllipse":"IAcadEllipse", "AcDbSpline":"IAcadSpline",
    # å¤šæ®µçº¿
    "AcDbPolyline":"IAcadLWPolyline", "AcDb2dPolyline":"IAcadPolyline", "AcDb3dPolyline":"IAcad3DPolyline",
    # æ–‡å­—
    "AcDbText":"IAcadText", "AcDbMText":"IAcadMText",
    # å—/å±æ€§
    "AcDbBlockReference":"IAcadBlockReference",
    "AcDbAttribute":"IAcadAttributeReference", "AcDbAttributeDefinition":"IAcadAttribute",
    # å¼•çº¿/æ ‡æ³¨ï¼ˆå¸¸ç”¨ï¼‰âœ¨ æ–°å¢
    "AcDbLeader":"IAcadLeader", "AcDbMLeader":"IAcadMLeader",
    "AcDbDimension":"IAcadDimension", "AcDbAlignedDimension":"IAcadDimAligned",
    "AcDbRotatedDimension":"IAcadDimRotated", "AcDbRadialDimension":"IAcadDimRadial",
    "AcDbDiametricDimension":"IAcadDimDiametric", "AcDbArcDimension":"IAcadDimArc",
    "AcDb3PointAngularDimension":"IAcadDim3PointAngular", "AcDb2LineAngularDimension":"IAcadDim2LineAngular",
    "AcDbOrdinateDimension":"IAcadDimOrdinate",
    # å…¶å®ƒ
    "AcDbHatch":"IAcadHatch", "AcDbTable":"IAcadTable",
}
```

**æ”¹è¿›**ï¼š
- âœ… æ–°å¢ 15 ä¸ªæ ‡æ³¨ç±»å‹æ˜ å°„
- âœ… æ–°å¢ 2 ä¸ªå±æ€§ç±»å‹æ˜ å°„
- âœ… ä¸ç¬¬å››éƒ¨åˆ†ä¿æŒä¸€è‡´

#### ä¿®æ”¹ç‚¹ 2ï¼šæ·»åŠ  `_maybe_cast()` å‡½æ•°

**æ–°å¢å‡½æ•°**ï¼ˆä½¿ç”¨ `com_retry` å®‰å…¨è½¬æ¢ï¼‰ï¼š
```python
def _maybe_cast(ent):
    """å®‰å…¨åœ°è½¬æ¢CADå¯¹è±¡åˆ°ä¸“ç”¨æ¥å£ï¼ˆä½¿ç”¨com_retryï¼‰"""
    try:
        name = com_retry(lambda: ent.ObjectName)
        iface = _CAST_MAP.get(name)
        if iface:
            try:
                return CastTo(ent, iface)
            except Exception:
                return ent
        return ent
    except Exception:
        return ent
```

**ä¼˜åŠ¿**ï¼š
- âœ… ä½¿ç”¨ `com_retry` å¤„ç† COM ç¹å¿™/RPCé”™è¯¯
- âœ… å¼‚å¸¸å®‰å…¨ï¼Œè½¬æ¢å¤±è´¥è¿”å›åŸå¯¹è±¡
- âœ… ä¸ç¬¬å››éƒ¨åˆ†å®ç°ä¸€è‡´

#### ä¿®æ”¹ç‚¹ 3ï¼šæ›´æ–° `cast_object()` å‡½æ•°

**ä¿®æ”¹å‰**ï¼ˆç›´æ¥è½¬æ¢ï¼‰ï¼š
```python
def cast_object(obj):
    """è½¬æ¢CADå¯¹è±¡åˆ°ä¸“ç”¨æ¥å£"""
    try:
        obj_name = obj.ObjectName
        if obj_name in _CAST_MAP:
            return CastTo(obj, _CAST_MAP[obj_name])
        return obj
    except:
        return obj
```

**ä¿®æ”¹å**ï¼ˆè°ƒç”¨ `_maybe_cast()`ï¼‰ï¼š
```python
def cast_object(obj):
    """è½¬æ¢CADå¯¹è±¡åˆ°ä¸“ç”¨æ¥å£ï¼ˆå…¼å®¹æ—§ä»£ç ï¼Œå†…éƒ¨è°ƒç”¨_maybe_castï¼‰"""
    return _maybe_cast(obj)
```

**æ”¹è¿›**ï¼š
- âœ… ç»Ÿä¸€è°ƒç”¨ `_maybe_cast()`
- âœ… è‡ªåŠ¨è·å¾— `com_retry` ä¿æŠ¤
- âœ… å…¼å®¹æ—§ä»£ç 

#### ä¿®æ”¹ç‚¹ 4ï¼šæ›´æ–° `get_object_property()` å‡½æ•°

**ä¿®æ”¹å‰**ï¼š
```python
def get_object_property(obj, property_name):
    try:
        obj_name = obj.ObjectName  # ç›´æ¥è®¿é—®ï¼Œå¯èƒ½å‡ºé”™
        if obj_name in _TARCH_PROPERTY_MAP:
            dispid = _TARCH_PROPERTY_MAP[obj_name].get(property_name)
            if dispid:
                return obj._oleobj_.Invoke(dispid, 0, pythoncom.DISPATCH_PROPERTYGET, True)
        obj = cast_object(obj)  # æ—§çš„è½¬æ¢æ–¹å¼
        return getattr(obj, property_name)
    except:
        return None
```

**ä¿®æ”¹å**ï¼š
```python
def get_object_property(obj, property_name):
    try:
        obj_name = com_retry(lambda: obj.ObjectName)  # âœ¨ ä½¿ç”¨ com_retry
        # å¤©æ­£å¯¹è±¡ï¼šä½¿ç”¨DISPIDæ–¹å¼è®¿é—®
        if obj_name in _TARCH_PROPERTY_MAP:
            dispid = _TARCH_PROPERTY_MAP[obj_name].get(property_name)
            if dispid:
                return obj._oleobj_.Invoke(dispid, 0, pythoncom.DISPATCH_PROPERTYGET, True)
        # CADæ ‡å‡†å¯¹è±¡ï¼šå…ˆCastå†è®¿é—®å±æ€§
        obj = _maybe_cast(obj)  # âœ¨ ä½¿ç”¨ _maybe_cast
        return getattr(obj, property_name)
    except Exception as e:
        return None
```

**æ”¹è¿›**ï¼š
- âœ… ä½¿ç”¨ `com_retry` å®‰å…¨è®¿é—® `ObjectName`
- âœ… ä½¿ç”¨ `_maybe_cast()` è½¬æ¢å¯¹è±¡
- âœ… æ·»åŠ æ³¨é‡Šè¯´æ˜å¤„ç†æµç¨‹

#### ä¿®æ”¹ç‚¹ 5ï¼šæ›´æ–° `set_object_property()` å‡½æ•°

**ä¿®æ”¹å‰**ï¼š
```python
def set_object_property(obj, property_name, value):
    try:
        obj_name = obj.ObjectName  # ç›´æ¥è®¿é—®
        if obj_name in _TARCH_PROPERTY_MAP:
            dispid = _TARCH_PROPERTY_MAP[obj_name].get(property_name)
            if dispid:
                obj._oleobj_.Invoke(dispid, 0, pythoncom.DISPATCH_PROPERTYPUT, True, value)
                return True
        obj = cast_object(obj)  # æ—§çš„è½¬æ¢æ–¹å¼
        setattr(obj, property_name, value)
        return True
    except:
        return False
```

**ä¿®æ”¹å**ï¼š
```python
def set_object_property(obj, property_name, value):
    try:
        obj_name = com_retry(lambda: obj.ObjectName)  # âœ¨ ä½¿ç”¨ com_retry
        # å¤©æ­£å¯¹è±¡ï¼šä½¿ç”¨DISPIDæ–¹å¼è®¾ç½®
        if obj_name in _TARCH_PROPERTY_MAP:
            dispid = _TARCH_PROPERTY_MAP[obj_name].get(property_name)
            if dispid:
                obj._oleobj_.Invoke(dispid, 0, pythoncom.DISPATCH_PROPERTYPUT, True, value)
                return True
        # CADæ ‡å‡†å¯¹è±¡ï¼šå…ˆCastå†è®¾ç½®å±æ€§
        obj = _maybe_cast(obj)  # âœ¨ ä½¿ç”¨ _maybe_cast
        setattr(obj, property_name, value)
        return True
    except Exception as e:
        return False
```

**æ”¹è¿›**ï¼š
- âœ… ä½¿ç”¨ `com_retry` å®‰å…¨è®¿é—® `ObjectName`
- âœ… ä½¿ç”¨ `_maybe_cast()` è½¬æ¢å¯¹è±¡
- âœ… æ·»åŠ æ³¨é‡Šè¯´æ˜å¤„ç†æµç¨‹

---

### 2. æ›´æ–° `scripts/CAD_object_properties.py`

**æ–‡ä»¶ä½ç½®**ï¼š`D:/claude-tasks/scripts/CAD_object_properties.py`

#### ä¿®æ”¹ç‚¹ 1ï¼šæ·»åŠ  `com_retry` å‡½æ•°

**æ–°å¢ä»£ç **ï¼ˆç¬¬ 18-38 è¡Œï¼‰ï¼š
```python
import pythoncom
import time
import pywintypes
from win32com.client import CastTo

# é€šç”¨é‡è¯•ï¼šå"å¿™/æ‹’ç»/RPC down"
_RPC_BUSY = (-2147417846, -2147418111)
_RPC_DOWN = (-2147023174,)

def com_retry(fn, retries=30, delay=0.05):
    """COMè°ƒç”¨é‡è¯•æœºåˆ¶"""
    for _ in range(retries):
        try:
            return fn()
        except pywintypes.com_error as e:
            code = e.args[0] if e.args else None
            if code in _RPC_BUSY + _RPC_DOWN:
                time.sleep(delay)
                continue
            raise
    return fn()
```

#### ä¿®æ”¹ç‚¹ 2ï¼šæ·»åŠ  `_maybe_cast()` å‡½æ•°

**æ–°å¢å‡½æ•°**ï¼ˆç¬¬ 89-114 è¡Œï¼‰ï¼š
```python
def _maybe_cast(ent):
    """
    å®‰å…¨åœ°è½¬æ¢CADå¯¹è±¡åˆ°ä¸“ç”¨æ¥å£ï¼ˆä½¿ç”¨com_retryï¼‰

    ç¤ºä¾‹:
        obj = last_obj()
        obj = _maybe_cast(obj)
        coords = obj.Coordinates  # è®¿é—®å¤šæ®µçº¿åæ ‡
    """
    try:
        name = com_retry(lambda: ent.ObjectName)
        iface = _CAST_MAP.get(name)
        if iface:
            try:
                return CastTo(ent, iface)
            except Exception:
                return ent
        return ent
    except Exception:
        return ent
```

#### ä¿®æ”¹ç‚¹ 3-5ï¼šæ›´æ–°å‡½æ•°å®ç°

ä¸ `CAD_basic.py` çš„ä¿®æ”¹ç›¸åŒï¼Œç»Ÿä¸€ä½¿ç”¨ `com_retry` å’Œ `_maybe_cast()`ã€‚

---

## âœ… éªŒè¯æµ‹è¯•

### æµ‹è¯•è„šæœ¬

**æ–‡ä»¶**ï¼š`D:/claude-tasks/test_object_properties.py`

### æµ‹è¯•ç»“æœ

```
============================================================
å¯¹è±¡å±æ€§å¤„ç†æ”¹è¿›æµ‹è¯•
============================================================

1. æµ‹è¯•æ¨¡å—å¯¼å…¥...
âœ… CAD_basic å¯¼å…¥æˆåŠŸ
   - _maybe_cast:  <function _maybe_cast at 0x...>
   - cast_object:  <function cast_object at 0x...>
   - get_object_property:  <function get_object_property at 0x...>
   - set_object_property:  <function set_object_property at 0x...>
âœ… CAD_object_properties å¯¼å…¥æˆåŠŸ
   - _maybe_cast:  <function _maybe_cast at 0x...>
   - cast_object:  <function cast_object at 0x...>
   - get_object_property:  <function get_object_property at 0x...>
   - set_object_property:  <function set_object_property at 0x...>

2. æµ‹è¯• _CAST_MAP æ˜ å°„...
âœ… CAD_basic._CAST_MAP åŒ…å« 27 ä¸ªæ˜ å°„
   âœ… AcDbLine -> IAcadLine
   âœ… AcDbCircle -> IAcadCircle
   âœ… AcDbPolyline -> IAcadLWPolyline
   âœ… AcDbAlignedDimension -> IAcadDimAligned
   âœ… AcDbRotatedDimension -> IAcadDimRotated
   âœ… AcDb3PointAngularDimension -> IAcadDim3PointAngular

3. æµ‹è¯•å‡½æ•°ç­¾å...
âœ… _maybe_cast(ent)
âœ… cast_object(obj)
âœ… get_object_property(obj, property_name)

============================================================
æµ‹è¯•å®Œæˆ - æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
============================================================
```

---

## ğŸ“– ä½¿ç”¨è¯´æ˜

### ä½¿ç”¨åœºæ™¯ 1ï¼šCAD æ ‡å‡†å¯¹è±¡ï¼ˆå¤šæ®µçº¿ã€åœ†ã€ç›´çº¿ç­‰ï¼‰

```python
# åˆå§‹åŒ–CADè¿æ¥
from CAD_basic import li, last_obj, _maybe_cast

li()  # è¿æ¥CAD

# è·å–æœ€ååˆ›å»ºçš„å¯¹è±¡
ob = last_obj()
print(ob.ObjectName)  # è¾“å‡ºï¼š'AcDbPolyline'

# è½¬æ¢åˆ°ä¸“ç”¨æ¥å£
ob = _maybe_cast(ob)

# ç›´æ¥è®¿é—®å±æ€§ï¼ˆè½¬æ¢åå¯ç”¨ï¼‰
coords = ob.Coordinates
print(coords)  # è¾“å‡ºåæ ‡å…ƒç»„
```

### ä½¿ç”¨åœºæ™¯ 2ï¼šå¤©æ­£å¯¹è±¡ï¼ˆé—¨çª—ã€å¢™ä½“ç­‰ï¼‰

```python
# åˆå§‹åŒ–CADè¿æ¥
from CAD_basic import li, last_obj, get_object_property, set_object_property

li()  # è¿æ¥CAD

# è·å–æœ€ååˆ›å»ºçš„å¯¹è±¡
ob = last_obj()
print(ob.ObjectName)  # è¾“å‡ºï¼š'TDbOpening'

# è·å–å±æ€§ï¼ˆä½¿ç”¨DISPIDæ–¹å¼ï¼‰
width = get_object_property(ob, 'Width')
print(f"å®½åº¦: {width}")  # è¾“å‡ºï¼šå®½åº¦: 900.0

# è®¾ç½®å±æ€§
set_object_property(ob, 'Width', 1200)
print(f"æ–°å®½åº¦: {get_object_property(ob, 'Width')}")  # è¾“å‡ºï¼šæ–°å®½åº¦: 1200.0
```

### ä½¿ç”¨åœºæ™¯ 3ï¼šç»Ÿä¸€å¤„ç†ï¼ˆè‡ªåŠ¨è¯†åˆ«å¯¹è±¡ç±»å‹ï¼‰

```python
from CAD_basic import get_object_property, _maybe_cast

# å‡½æ•°è‡ªåŠ¨è¯†åˆ«å¯¹è±¡ç±»å‹å¹¶é€‰æ‹©æ­£ç¡®çš„å¤„ç†æ–¹å¼
def process_object(obj):
    obj_name = obj.ObjectName

    if obj_name.startswith('TDb'):
        # å¤©æ­£å¯¹è±¡ - ä½¿ç”¨ get_object_property
        width = get_object_property(obj, 'Width')
        print(f"å¤©æ­£å¯¹è±¡å®½åº¦: {width}")
    else:
        # CADæ ‡å‡†å¯¹è±¡ - ä½¿ç”¨ _maybe_cast
        obj = _maybe_cast(obj)
        if hasattr(obj, 'Coordinates'):
            print(f"CADå¯¹è±¡åæ ‡: {obj.Coordinates}")
```

---

## ğŸ“Š æ”¹è¿›æ€»ç»“

### 1. åŠŸèƒ½å®Œå–„

| é¡¹ç›® | ä¿®æ”¹å‰ | ä¿®æ”¹å | æ”¹è¿› |
|-----|--------|--------|------|
| CADå¯¹è±¡ç±»å‹æ˜ å°„ | 12 ä¸ª | 27 ä¸ª | +15 ä¸ªæ ‡æ³¨ç±»å‹ |
| ç±»å‹è½¬æ¢å‡½æ•° | `cast_object()` | `_maybe_cast()` + `cast_object()` | å¢å¼ºå®‰å…¨æ€§ |
| COMè°ƒç”¨å®‰å…¨æ€§ | æ— é‡è¯•æœºåˆ¶ | `com_retry` é‡è¯• | å¤„ç†RPCé”™è¯¯ |
| ä»£ç ä¸€è‡´æ€§ | ä¸ä¸€è‡´ | ä¸ç¬¬å››éƒ¨åˆ†ä¸€è‡´ | ç»Ÿä¸€è§„èŒƒ |

### 2. å®‰å…¨æ€§æå‡

- âœ… **COMè°ƒç”¨ä¿æŠ¤**ï¼šä½¿ç”¨ `com_retry` å¤„ç†ç¹å¿™/RPCé”™è¯¯ï¼Œè‡ªåŠ¨é‡è¯• 30 æ¬¡
- âœ… **å¼‚å¸¸å®‰å…¨**ï¼šæ‰€æœ‰è½¬æ¢å‡½æ•°éƒ½æœ‰å¼‚å¸¸ä¿æŠ¤ï¼Œå¤±è´¥è¿”å›åŸå¯¹è±¡
- âœ… **å…¼å®¹æ€§**ï¼šä¿ç•™ `cast_object()` æ¥å£ï¼Œå…¼å®¹æ—§ä»£ç 

### 3. ä»£ç è§„èŒƒ

- âœ… **ç»Ÿä¸€å®ç°**ï¼šç¬¬å››éƒ¨åˆ†å’Œç¬¬åä¸€éƒ¨åˆ†ä½¿ç”¨ç›¸åŒçš„å®ç°
- âœ… **æ¸…æ™°æ³¨é‡Š**ï¼šæ·»åŠ è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šè¯´æ˜å¤„ç†æµç¨‹
- âœ… **æ–‡æ¡£å®Œå–„**ï¼šæä¾›å®Œæ•´çš„ä½¿ç”¨è¯´æ˜å’Œç¤ºä¾‹

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶

1. âœ… `scripts/CAD_basic.py`ï¼ˆç¬¬åä¸€éƒ¨åˆ†ï¼Œ14798-14888è¡Œï¼‰
2. âœ… `scripts/CAD_object_properties.py`ï¼ˆå…¨æ–‡æ›´æ–°ï¼‰

### æ–°å¢çš„æ–‡ä»¶

3. âœ… `test_object_properties.py`ï¼ˆæµ‹è¯•è„šæœ¬ï¼‰
4. âœ… `å¯¹è±¡å±æ€§å¤„ç†æ”¹è¿›æŠ¥å‘Š.md`ï¼ˆæœ¬æ–‡ä»¶ï¼‰

### æœªä¿®æ”¹çš„æ–‡ä»¶

- `scripts/CAD_tarch_properties.py`ï¼ˆä¸“é—¨å¤„ç†å¤©æ­£å¯¹è±¡ï¼Œæ— éœ€ä¿®æ”¹ï¼‰

---

## ğŸ¯ åç»­å»ºè®®

### 1. ä½¿ç”¨å»ºè®®

- **æ¨è**ï¼šä¼˜å…ˆä½¿ç”¨ `_maybe_cast()` å¤„ç† CAD æ ‡å‡†å¯¹è±¡
- **æ¨è**ï¼šä¼˜å…ˆä½¿ç”¨ `get_object_property()` å’Œ `set_object_property()` ç»Ÿä¸€æ¥å£
- **æ³¨æ„**ï¼š`cast_object()` ä¿ç•™æ˜¯ä¸ºäº†å…¼å®¹æ€§ï¼Œæ–°ä»£ç åº”ä½¿ç”¨ `_maybe_cast()`

### 2. æ‰©å±•å»ºè®®

å¦‚éœ€æ”¯æŒæ›´å¤šå¯¹è±¡ç±»å‹ï¼Œå¯ä»¥åœ¨ `_CAST_MAP` ä¸­æ·»åŠ æ˜ å°„ï¼š

```python
_CAST_MAP = {
    # ç°æœ‰æ˜ å°„...
    "AcDbæ–°å¯¹è±¡ç±»å‹": "IAcadæ–°æ¥å£ç±»å‹",  # æ·»åŠ æ–°æ˜ å°„
}
```

### 3. æµ‹è¯•å»ºè®®

åœ¨å®é™… CAD ç¯å¢ƒä¸­æµ‹è¯•ï¼š
1. å¯åŠ¨ CAD å¹¶æ‰“å¼€å›¾çº¸
2. è¿è¡Œ `li()` åˆå§‹åŒ–è¿æ¥
3. åˆ›å»ºæˆ–é€‰æ‹©ä¸åŒç±»å‹çš„å¯¹è±¡
4. ä½¿ç”¨ `_maybe_cast()` å’Œ `get_object_property()` éªŒè¯

---

## âœ… ä»»åŠ¡å®Œæˆç¡®è®¤

- âœ… æ›´æ–°äº† `_CAST_MAP`ï¼Œæ·»åŠ å®Œæ•´çš„æ ‡æ³¨ç±»å‹æ˜ å°„
- âœ… æ·»åŠ äº† `_maybe_cast()` å‡½æ•°ï¼Œä½¿ç”¨ `com_retry` å®‰å…¨è½¬æ¢
- âœ… æ›´æ–°äº† `cast_object()` å‡½æ•°ï¼Œè°ƒç”¨ `_maybe_cast()`
- âœ… æ›´æ–°äº† `get_object_property()` å’Œ `set_object_property()` å‡½æ•°
- âœ… åŒæ­¥æ›´æ–°äº† `CAD_object_properties.py` æ¨¡å—
- âœ… åˆ›å»ºäº†æµ‹è¯•è„šæœ¬å¹¶éªŒè¯é€šè¿‡
- âœ… ç¼–å†™äº†å®Œæ•´çš„æ”¹è¿›æŠ¥å‘Š

**æ‰€æœ‰ä¿®æ”¹å·²å®Œæˆå¹¶é€šè¿‡æµ‹è¯•ï¼** ğŸ‰

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2025-11-10
**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0
